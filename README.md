# Canalia

é‡ç”°åœ°åŒºç†å¤§ç¥­ã‚¦ã‚§ãƒ–ãƒãƒ¼ã‚¿ãƒ« - Next.js ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ Go API ã‚µãƒ¼ãƒãƒ¼ã‚’çµ„ã¿åˆã‚ã›ãŸãƒ¢ãƒãƒ¬ãƒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### å¿…è¦ãªãƒ„ãƒ¼ãƒ«

ä»¥ä¸‹ã®ãƒ„ãƒ¼ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

- **Node.js** v20 LTSä»¥é™ ([ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰](https://nodejs.org/))
- **pnpm** v10ä»¥é™ (`npm install -g pnpm`)
- **Go** v1.24ä»¥é™ ([ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰](https://golang.org/dl/))
- **Taskfile** ([ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †](https://taskfile.dev/installation/))
- **Docker** ([ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †](https://docs.docker.com/get-docker/))

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# 1. ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone git@github.com:s-union/canalia.git
cd canalia

# 2. è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’å®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰
task setup
```

ã“ã‚Œã§ä»¥ä¸‹ãŒè‡ªå‹•å®Ÿè¡Œã•ã‚Œã¾ã™ï¼š
- âœ… å¿…è¦ãªãƒ„ãƒ¼ãƒ«ã®ç¢ºèª
- ğŸ“¦ ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«  
- âš™ï¸ ç’°å¢ƒè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ
- ğŸ”§ å‹å®šç¾©ã®ç”Ÿæˆ
- ğŸ§ª ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®æ¤œè¨¼

## `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®š

`.env.exmple` ã‚’è¦‹ãªãŒã‚‰ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

## ğŸ› ï¸ é–‹ç™º

### é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºï¼ˆå¾“æ¥ã®æ–¹æ³•ï¼‰
task dev                # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’åŒæ™‚èµ·å‹•
task dev:client         # Next.js ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
task dev:server         # Go API ã‚µãƒ¼ãƒãƒ¼

```

### ãã®ä»–ã®é–‹ç™ºã‚¿ã‚¹ã‚¯

```bash
# ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–‹ç™º
task storybook

# ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
task format

# ãƒªãƒ³ãƒˆæ¤œæŸ»
task lint

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
task test

# ãƒ“ãƒ«ãƒ‰
task build
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–‹ç™º

**Docker ãŒå¿…è¦ã§ã™ã€‚** PostgreSQL 16ã‚’Docker Composeã§ç®¡ç†ã—ã¾ã™ã€‚

```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆåˆå›ã®ã¿ï¼‰
task db:dev:setup

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ
task db:dev:migrate:up     # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
task db:dev:migrate:down   # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å·»ãæˆ»ã—
task db:migrate:create     # æ–°ã—ã„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆ
task db:generate          # SQLã‹ã‚‰Goã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
task db:dev:clean         # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢

# Dockeræ“ä½œ
task docker:up            # PostgreSQLèµ·å‹•
task docker:down          # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åœæ­¢
task docker:clean         # ã‚³ãƒ³ãƒ†ãƒŠã¨ãƒœãƒªãƒ¥ãƒ¼ãƒ å‰Šé™¤
task docker:dev           # ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯é–‹ç™ºç’°å¢ƒèµ·å‹•
task docker:dev:logs      # å…¨ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ­ã‚°è¡¨ç¤º
task docker:dev:build     # é–‹ç™ºã‚³ãƒ³ãƒ†ãƒŠã®ãƒªãƒ“ãƒ«ãƒ‰
```

## âš™ï¸ ç’°å¢ƒè¨­å®š

åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å¾Œã€`apps/go-api/.env.local` ã‚’ç·¨é›†ã—ã¦Auth0è¨­å®šã‚’è¡Œã£ã¦ãã ã•ã„ï¼š

```bash
AUTH0_DOMAIN=your-auth0-domain.auth0.com
AUTH0_CLIENT_ID=your-client-id
AUTH0_CLIENT_SECRET=your-client-secret
AUTH0_AUDIENCE=your-api-identifier
```

## ğŸ“‹ åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰

ã™ã¹ã¦ã®ã‚¿ã‚¹ã‚¯ã‚’ç¢ºèªï¼š
```bash
task --list
```

## ğŸ—ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
canalia/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ next-app/        # Next.js ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/  # UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â””â”€â”€ generated/   # ç”Ÿæˆã•ã‚ŒãŸå‹å®šç¾©
â”‚   â””â”€â”€ go-api/          # Go API ã‚µãƒ¼ãƒãƒ¼
â”‚       â”œâ”€â”€ internal/    # ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰
â”‚       â”‚   â”œâ”€â”€ api/     # APIãƒãƒ³ãƒ‰ãƒ©ãƒ¼
â”‚       â”‚   â”œâ”€â”€ middleware/ # ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”‚       â”‚   â””â”€â”€ types/   # ç”Ÿæˆã•ã‚ŒãŸå‹å®šç¾©
â”‚       â””â”€â”€ main.go
â”œâ”€â”€ schema/
â”‚   â””â”€â”€ openapi.yaml     # APIä»•æ§˜æ›¸
â””â”€â”€ Taskfile.yml         # ãƒ“ãƒ«ãƒ‰ã‚¿ã‚¹ã‚¯å®šç¾©
```

## ğŸ”„ é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

### APIé–‹ç™º
1. `schema/openapi.yaml` ã§APIä»•æ§˜ã‚’å®šç¾©
2. `task openapi-gen` ã§å‹å®šç¾©ã‚’ç”Ÿæˆ
3. `apps/go-api/internal/api/` ã§ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’å®Ÿè£…
4. `api.RegisterRoutes()` ã§ãƒ«ãƒ¼ãƒˆã‚’ç™»éŒ²

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™º
1. `apps/next-app/src/components/` ã§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆ
2. `task storybook` ã§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’é–‹ç™º
3. ç”Ÿæˆã•ã‚ŒãŸå‹å®šç¾©ã‚’ä½¿ç”¨ã—ã¦APIå‘¼ã³å‡ºã—

## ğŸ§ª ãƒ†ã‚¹ãƒˆ

```bash
# ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
task test

# ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆï¼ˆVitestï¼‰
pnpm -C apps/next-app test

# ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ†ã‚¹ãƒˆï¼ˆStorybookï¼‰
task storybook
```

## ğŸ“š æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- **Next.js 15** - React ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **Tailwind CSS** - ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°
- **Storybook** - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–‹ç™º
- **Vitest** - ãƒ†ã‚¹ãƒˆ
- **openapi-fetch** - å‹å®‰å…¨APIå‘¼ã³å‡ºã—

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- **Go** - API ã‚µãƒ¼ãƒãƒ¼
- **Echo** - Web ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **Auth0** - èªè¨¼
- **PostgreSQL 16** - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆDockerï¼‰
- **sqlc** - å‹å®‰å…¨ãªSQLã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
- **golang-migrate** - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- **oapi-codegen** - OpenAPIå‹ç”Ÿæˆ

### é–‹ç™ºãƒ„ãƒ¼ãƒ«
- **Taskfile** - ã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼
- **Docker & Docker Compose** - ã‚³ãƒ³ãƒ†ãƒŠç®¡ç†
- **Biome** - ãƒªãƒ³ã‚¿ãƒ¼ãƒ»ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼
- **pnpm** - ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
- **Lefthook** - Git ãƒ•ãƒƒã‚¯

## ğŸ†˜ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã§å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆ

```bash
# å‰ææ¡ä»¶ã‚’å†ç¢ºèª
task check-prerequisites

# ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ã¦å†ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
task clean
task setup
```

### å‹ç”Ÿæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ

```bash
# OpenAPI ã‚¹ã‚­ãƒ¼ãƒã‚’ç¢ºèª
task openapi-gen
```

### é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ãªã„å ´åˆ

```bash
# ç’°å¢ƒè¨­å®šã‚’ç¢ºèª
task check-env

# ä¾å­˜é–¢ä¿‚ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
task clean
task install-deps
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ

```bash
# DockerãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
docker ps

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å†èµ·å‹•
task docker:down
task docker:up

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã¨å†ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
task docker:clean
task db:dev:setup
```
